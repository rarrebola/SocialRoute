DROP TABLE COMENTARIO CASCADE CONSTRAINTS PURGE;

DROP TABLE USUARIO_RUTAS CASCADE CONSTRAINTS PURGE;

DROP TABLE VALORACION CASCADE CONSTRAINTS PURGE;

DROP TABLE RUTA CASCADE CONSTRAINTS PURGE;

DROP TABLE LUGAR_DE_INTERES CASCADE CONSTRAINTS PURGE;

DROP TABLE USUARIO CASCADE CONSTRAINTS PURGE;

DROP TABLE CIUDAD CASCADE CONSTRAINTS PURGE;

DROP TABLE REGION CASCADE CONSTRAINTS PURGE;

DROP TABLE PAIS CASCADE CONSTRAINTS PURGE;

CREATE TABLE PAIS
(
	CODIGO_PAIS          VARCHAR2(2 CHAR) NOT NULL ,
	NOMBRE_PAIS          VARCHAR2(50 CHAR) NOT NULL ,
	CONTINENTE           VARCHAR2(50 CHAR) NOT NULL ,
	BANDERA_PAIS         ORDImage NULL ,
 PRIMARY KEY (CODIGO_PAIS)
);

CREATE TABLE REGION
(
	CODIGO_PAIS          VARCHAR2(2 CHAR) NOT NULL ,
	NOMBRE_REGION        VARCHAR2(50 CHAR) NOT NULL ,
	BANDERA_REGION       ORDImage NULL ,
 PRIMARY KEY (CODIGO_PAIS,NOMBRE_REGION),
FOREIGN KEY (CODIGO_PAIS) REFERENCES PAIS (CODIGO_PAIS)
);

CREATE TABLE CIUDAD
(
	CODIGO_PAIS          VARCHAR2(2 CHAR) NOT NULL ,
	NOMBRE_REGION        VARCHAR2(50 CHAR) NOT NULL ,
	NOMBRE_CIUDAD        VARCHAR2(100 CHAR) NOT NULL ,
	MAPA                 ORDImage NULL ,
 PRIMARY KEY (CODIGO_PAIS,NOMBRE_REGION,NOMBRE_CIUDAD),
FOREIGN KEY (CODIGO_PAIS, NOMBRE_REGION) REFERENCES REGION (CODIGO_PAIS, NOMBRE_REGION)
);

CREATE TABLE USUARIO
(
	NOMBRE_USUARIO       VARCHAR2(50 CHAR) NOT NULL ,
	CODIGO_PAIS          VARCHAR2(2 CHAR) NULL ,
	CONTRASENA           VARCHAR2(50 CHAR) NOT NULL ,
	EMAIL                VARCHAR2(100 CHAR) NOT NULL ,
	NOMBRE_REGION        VARCHAR2(50 CHAR) NULL ,
	NOMBRE_CIUDAD        VARCHAR2(100 CHAR) NULL ,
 PRIMARY KEY (NOMBRE_USUARIO),
FOREIGN KEY (CODIGO_PAIS) REFERENCES PAIS (CODIGO_PAIS) ON DELETE SET NULL,
FOREIGN KEY (CODIGO_PAIS, NOMBRE_REGION, NOMBRE_CIUDAD) REFERENCES CIUDAD (CODIGO_PAIS, NOMBRE_REGION, NOMBRE_CIUDAD) ON DELETE SET NULL,
FOREIGN KEY (CODIGO_PAIS, NOMBRE_REGION) REFERENCES REGION (CODIGO_PAIS, NOMBRE_REGION) ON DELETE SET NULL
);

CREATE TABLE LUGAR_DE_INTERES
(
	CODIGO_PAIS          VARCHAR2(2 CHAR) NOT NULL ,
	NOMBRE_REGION        VARCHAR2(50 CHAR) NOT NULL ,
	NOMBRE_CIUDAD        VARCHAR2(100 CHAR) NOT NULL ,
	NOMBRE_LI            VARCHAR2(100 CHAR) NOT NULL ,
	DESCRIPCION          VARCHAR2(250 CHAR) NULL ,
	FOTO                 ORDImage NULL ,
 PRIMARY KEY (CODIGO_PAIS,NOMBRE_REGION,NOMBRE_CIUDAD,NOMBRE_LI),
FOREIGN KEY (CODIGO_PAIS, NOMBRE_REGION, NOMBRE_CIUDAD) REFERENCES CIUDAD (CODIGO_PAIS, NOMBRE_REGION, NOMBRE_CIUDAD)
);

CREATE TABLE RUTA
(
	NOMBRE_RUTA          VARCHAR2(100 CHAR) NOT NULL ,
	NOMBRE_USUARIO       VARCHAR2(50 CHAR) NOT NULL ,
	DURACION             INTEGER NULL ,
	DESCRIPCION          VARCHAR2(250 CHAR) NULL ,
	CODIGO_PAIS          VARCHAR2(2 CHAR) NULL ,
	NOMBRE_REGION        VARCHAR2(50 CHAR) NULL ,
	NOMBRE_CIUDAD        VARCHAR2(100 CHAR) NULL ,
	NOMBRE_LI            VARCHAR2(100 CHAR) NULL ,
	VALORACION_MEDIA     NUMERIC(2,2) NULL ,
 PRIMARY KEY (NOMBRE_RUTA,NOMBRE_USUARIO),
FOREIGN KEY (NOMBRE_USUARIO) REFERENCES USUARIO (NOMBRE_USUARIO),
FOREIGN KEY (CODIGO_PAIS, NOMBRE_REGION, NOMBRE_CIUDAD, NOMBRE_LI) REFERENCES LUGAR_DE_INTERES (CODIGO_PAIS, NOMBRE_REGION, NOMBRE_CIUDAD, NOMBRE_LI) ON DELETE SET NULL
);

CREATE TABLE VALORACION
(
	NOMBRE_USUARIO       VARCHAR2(50 CHAR) NOT NULL ,
	NOMBRE_RUTA          VARCHAR2(100 CHAR) NOT NULL ,
	VALORACION           INTEGER NOT NULL ,
 PRIMARY KEY (NOMBRE_USUARIO,NOMBRE_RUTA),
FOREIGN KEY (NOMBRE_USUARIO) REFERENCES USUARIO (NOMBRE_USUARIO),
FOREIGN KEY (NOMBRE_RUTA, NOMBRE_USUARIO) REFERENCES RUTA (NOMBRE_RUTA, NOMBRE_USUARIO)
);

CREATE TABLE USUARIO_RUTAS
(
	NOMBRE_USUARIO       VARCHAR2(50 CHAR) NOT NULL ,
	NOMBRE_RUTA          VARCHAR2(100 CHAR) NOT NULL ,
 PRIMARY KEY (NOMBRE_USUARIO,NOMBRE_RUTA),
FOREIGN KEY (NOMBRE_USUARIO) REFERENCES USUARIO (NOMBRE_USUARIO),
FOREIGN KEY (NOMBRE_RUTA, NOMBRE_USUARIO) REFERENCES RUTA (NOMBRE_RUTA, NOMBRE_USUARIO)
);

CREATE TABLE COMENTARIO
(
	ID_COMENTARIO        INTEGER NOT NULL ,
	NOMBRE_USUARIO       VARCHAR2(50 CHAR) NOT NULL ,
	COMENTARIO           VARCHAR2(500 CHAR) NOT NULL ,
	NOMBRE_RUTA          VARCHAR2(100 CHAR) NULL ,
 PRIMARY KEY (ID_COMENTARIO,NOMBRE_USUARIO),
FOREIGN KEY (NOMBRE_RUTA, NOMBRE_USUARIO) REFERENCES RUTA (NOMBRE_RUTA, NOMBRE_USUARIO) ON DELETE SET NULL,
FOREIGN KEY (NOMBRE_USUARIO) REFERENCES USUARIO (NOMBRE_USUARIO)
);
